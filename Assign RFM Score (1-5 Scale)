CREATE TEMPORARY TABLE RFM_Scores AS
SELECT 
    customer_id,
    Recency,
    Frequency,
    Monetary,
    NTILE(5) OVER (ORDER BY Recency DESC) AS R_Score,   -- Smaller days = better
    NTILE(5) OVER (ORDER BY Frequency ASC) AS F_Score,  -- Higher = better
    NTILE(5) OVER (ORDER BY Monetary ASC) AS M_Score    -- Higher = better
FROM RFM
ORDER BY customer_id;

SELECT * FROM RFM_Scores;
